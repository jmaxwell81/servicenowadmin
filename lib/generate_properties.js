
gs.getSession().setStrictQuery(true);

gs.print('RESULT\nvar tocompareto = ' + generate_script_hashes('sys_properties','nameINglide.authenticate.multisso.user.autoprovision',"name,value")+";");

var tocompareto = {"glide.authenticate.sso.saml2.keystore":{"value":"b88267271b012000f1129141be071393"},"glide.script.allow_unsafe_gs_sql":{"value":"false"},"glide.ui.session_timeout":{"value":"30"},"com.glide.communications.trustmanager_trust_all":{"value":"false"},"glide.outbound.sslv3.disabled":{"value":"true"},"glide.security.file.mime_type.validation":{"value":"false"},"glide.security.forgot_password.display.link":{"value":"true"},"glide.security.password_reset.uri":{"value":"/$pwd_reset.do?sysparm_url=ss_default"},"glide.basicauth.required.xmloutputprocessor":{"value":"true"},"glide.security.scoped_administration.honor_global_acl":{"value":"true"},"glide.security.expander.view.legacy":{"value":"false"},"glide.security.scoped_administration":{"value":"true"},"glide.security.multisso.check_table_exists_for_clone":{"value":"true"},"glide.authenticate.multisso.user.autoprovision":{"value":"false"},"glide.security.admin.override.accessterm":{"value":"true"},"glide.basicauth.required.schema":{"value":"true"},"glide.soap.request_processing_timeout":{"value":"60"},"glide.authenticate.sso.saml2.idp.supportForceAuthn":{"value":"true"},"glide.security.groupby_acl_check":{"value":"true"},"glide.userauthgate.extauth.check":{"value":"true"},"glide.basicauth.required.api":{"value":"true"},"glide.authenticate.multisso.login_locate.user_field":{"value":"user_name"},"glide.authenticate.multisso.enabled":{"value":"false"},"glide.authenticate.multisso.debug":{"value":"false"},"glide.security.diag_txns_acl":{"value":"false"},"glide.basicauth.required.jsonv2":{"value":"true"},"glide.authenticate.sso.saml2.require_signed_authnrequest":{"value":"false"},"glide.authenticate.sso.saml2.sign_algorithmURI":{"value":"http://www.w3.org/2000/09/xmldsig#rsa-sha1"},"glide.security.csrf.strict.validation.mode":{"value":"false"},"glide.login.autocomplete":{"value":"false"},"glide.security.strict_elevate_privilege":{"value":"true"},"glide.security.sandbox_no_logging":{"value":"true"},"glide.authenticate.sso.saml2.signing_key_password":{"value":"saml2sp"},"glide.authenticate.sso.saml2.signing_key_alias":{"value":"saml2sp"},"glide.authenticate.sso.saml2.idp_logout_binding":{"value":"urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect"},"glide.authenticate.sso.saml2.require_signed_logoutrequest":{"value":"false"},"glide.authenticate.sso.saml2.clockskew":{"value":"180"},"glide.authenticate.sso.saml2.idp":{"value":"http://idp.ssocircle.com"},"glide.authenticate.sso.saml2.audience":{"value":"https://yourinstance.service-now.com"},"glide.authenticate.sso.saml2.createrequestedauthncontext":{"value":"true"},"glide.authenticate.sso.saml2.authncontextclassref":{"value":"urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"},"glide.ui.attachment.download_mime_types":{"value":"text/html,image/svg,image/svg+xml"},"glide.ui.escape_all_script":{"value":"true"},"glide.set_x_frame_options":{"value":"true"},"glide.cms.catalog_uri_relative":{"value":"true"},"glide.sm.default_mode":{"value":"deny"},"glide.authenticate.sso.saml2.debug":{"value":"false"},"glide.authenticate.failed_redirect":{"value":"logout_success.do"},"glide.authenticate.external.logout_redirect":{"value":"external_logout_complete.do"},"glide.authentication.external.disable_local_login":{"value":"true"},"glide.security.csrf_previous.time_limit":{"value":"86400"},"glide.security.use_csrf_token":{"value":"true"},"glide.security.csrf_previous.allow":{"value":"false"},"glide.ui.escape_html_list_field":{"value":"true"},"glide.ui.escape_text":{"value":"true"},"glide.html.escape_script":{"value":"true"},"glide.ui.rotate_sessions":{"value":"true"},"glide.security.strict.actions":{"value":"true"},"glide.smtp.auth":{"value":"false"},"glide.authenticate.sso.saml2.idp_authnrequest_url":{"value":"https://idp.ssocircle.com:443/sso/SSORedirect/metaAlias/ssocircle"},"glide.authenticate.sso.saml2.idp_logout_url":{"value":"https://idp.ssocircle.com:443/sso/IDPSloRedirect/metaAlias/ssocircle"},"glide.authenticate.sso.saml2.nameid_policy":{"value":"urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress"},"glide.authenticate.sso.saml2.user_field":{"value":"user_name"},"glide.authenticate.sso.saml2.issuer":{"value":"https://yourinstance.service-now.com"},"glide.authenticate.sso.saml2.service_url":{"value":"https://yourinstance.service-now.com/navpage.do"},"glide.authenticate.failed_requirement_redirect":{"value":"https://idp.ssocircle.com:443/sso/SSORedirect/metaAlias/ssocircle"},"glide.ui.security.codetag.allow_script":{"value":"false"},"glide.basicauth.required.scriptedprocessor":{"value":"true"},"glide.script.secure.ajaxgliderecord":{"value":"true"},"glide.script.allow.ajaxevaluate":{"value":"false"},"glide.script.use.sandbox":{"value":"true"},"glide.security.strict.updates":{"value":"true"},"glide.basicauth.required.xsd":{"value":"true"},"com.glide.attachment.max_size":{"value":"1024"},"glide.basicauth.required.importprocessor":{"value":"true"},"glide.secure_cookie.debug":{"value":"false"},"glide.basicauth.required.xml":{"value":"true"},"glide.basicauth.required.unl":{"value":"true"},"glide.entry.page.script":{"value":"new CMSEntryPage().getEntryPage()"},"glide.ui.secure_cookies":{"value":"true"},"glide.ui.security.allow_codetag":{"value":"true"},"glide.basicauth.required.pdf":{"value":"true"},"glide.basicauth.required.excel":{"value":"true"},"glide.basicauth.required.csv":{"value":"true"},"glide.ldap.authentication":{"value":"true"},"glide.soap.strict_security":{"value":"true"},"glide.authenticate.secret_key":{"value":""},"glide.authenticate.header.encrypted_key":{"value":"DE_USER"},"glide.security.explain.write.locks":{"value":"false"},"glide.security.granular.create":{"value":"true"},"glide.security.manager":{"value":"com.glide.sys.security.ContextualSecurityManager"},"glide.basicauth.required.rss":{"value":"true"},"glide.basicauth.required.wsdl":{"value":"true"},"glide.basicauth.required.soap":{"value":"true"},"glide.soapprocessor.large_field_patch_max":{"value":"512000"},"glide.authenticate.header.value":{"value":"user_name"},"glide.authenticate.header.key":{"value":"SM_USER"},"glide.authenticate.external":{"value":"false"}};
gs.print('RESULT\n' + compareproperties('nameINcom.glide.ssl.read.timeout,glide.http.connection_timeout,glide.http.timeout,glide.integration.session_timeout,glide.security.auto.resubmit.ajax,glide.security.csrf.handle.ajax.timeout,glide.security.ssl.ciphersuites,glide.security.ssl.protocols,glide.session.unauthorized.timeout,glide.session.unauthorized.timeout.enabled,glide.soap.max_redirects,glide.soap.request_processing_timeout,glide.soapprocessor.allow_long_running_threads,glide.soapprocessor.max_long_running_threads,glide.ui.auto_req.extend.session,glide.ui.session_timeout',tocompareto));
  
gs.print('RESULT\nvar tocompareto = ' + generate_properties('nameINglide.authenticate.multisso.user.autoprovision,glide.authenticate.multisso.test.connection.mandatory,glide.authenticate.external,glide.authenticate.multisso.enabled,glide.authenticate.multisso.debug,glide.authenticate.multisso.login_locate.user_field,glide.authenticate.sso.saml2.keystore,glide.security.url.whitelist,glide.authenticate.auth.validate.url,glide.authenticate.external.logout_redirect,glide.authenticate.failed_redirect,glide.authenticate.failed_requirement_redirect,glide.authenticate.external.use_redirect_page,glide.authentication.external.disable_local_login,glide.userauthgate.extauth.check,glide.security.handle.ms_special_request,glide.saml2.session_request_id_arr,glide.authenticate.external.side_door_uri,glide.entry.page.script,glide.entry.page,glide.entry.first.page.script,glide.entry.loggedin.page,glide.entry.loggedin.page_ess,glide.authenticate.sso.saml2.debug,glide.authenticate.sso.saml2.clockskew,glide.authenticate.sso.redirect.idp,glide.ldap.authentication,glide.script,glide.ui.escape_all_script,glide.ui.security.codetag.allow_script,glide.ui.security.allow_codetag,com.glide.attachment.max_size,glide.security.file.mime_type.validation,glide.security.manager,glide.sm.default_mode,glide.security.strict.updates,glide.security.granular.create,glide.security.explain.write.locks,glide.ui.forgetme,glide.ui.secure_cookies,glide.secure_cookie.debug,glide.script.use.sandbox,glide.script.allow.ajaxevaluate,glide.script.secure.ajaxgliderecord,com.glide.communications.trustmanager_trust_all,glide.outbound.sslv3.disabled,glide.ui.escape_text,glide.ui.rotate_sessions,glide.security.password_reset.uri,glide.security.strict.actions,glide.security.use_csrf_token,glide.ui.escape_html_list_field,glide.html.escape_script,glide.smtp.auth,glide.soap.strict_security,glide.basicauth.required.wsdl,glide.basicauth.required.csv,glide.basicauth.required.excel,glide.basicauth.required.importprocessor,glide.basicauth.required.pdf,glide.basicauth.required.rss,glide.basicauth.required.scriptedprocessor,glide.basicauth.required.soap,glide.basicauth.required.unl,glide.basicauth.required.xml,glide.basicauth.required.xsd,glide.cms.catalog_uri_relative,glide.set_x_frame_options,glide.ui.attachment.download_mime_types,glide.security.groupby_acl_check,glide.security.diag_txns_acl,glide.login.autocomplete,glide.security.csrf_previous.allow,glide.security.csrf_previous.time_limit,glide.security.csrf.strict.validation.mode,glide.basicauth.required.schema,glide.http.connection_timeout,glide.http.timeout,glide.soap.max_redirects,glide.soap.request_processing_timeout,glide.soapprocessor.allow_long_running_threads,glide.soapprocessor.max_long_running_threads,glide.security.csrf.handle.ajax.timeout,glide.security.auto.resubmit.ajax,glide.ui.auto_req.extend.session,glide.session.unauthorized.timeout.enabled,glide.session.unauthorized.timeout,glide.ui.session_timeout,com.glide.ssl.read.timeout,glide.integration.session_timeout,glide.security.ssl.protocols,glide.security.ssl.ciphersuites^ORnameSTARTSWITHglide.authenticate.^ORnameSTARTSWITHglide.security.^ORnameSTARTSWITHglide.entry.^ORnameSTARTSWITHglide.script.^ORnameSTARTSWITHglide.basicauth.^ORnameSTARTSWITHglide.session.^ORnameSTARTSWITHglide.soapprocessor.')+";");
var tocompareto = {"glide.authenticate.multisso.user.autoprovision":{"value":"93196323"}};
gs.print('RESULT\n' + compare_script_hashes('sys_properties','nameINglide.authenticate.multisso.user.autoprovision',tocompareto,"name,value"));

// generate_properties ======
// gs.print('RESULT\nvar tocompareto = ' + generate_properties('nameINglide.authenticate.multisso.user.autoprovision,glide.authenticate.multisso.test.connection.mandatory,glide.authenticate.external,glide.authenticate.multisso.enabled,glide.authenticate.multisso.debug,glide.authenticate.multisso.login_locate.user_field,glide.authenticate.sso.saml2.keystore,glide.security.url.whitelist,glide.authenticate.auth.validate.url,glide.authenticate.external.logout_redirect,glide.authenticate.failed_redirect,glide.authenticate.failed_requirement_redirect,glide.authenticate.external.use_redirect_page,glide.authentication.external.disable_local_login,glide.userauthgate.extauth.check,glide.security.handle.ms_special_request,glide.saml2.session_request_id_arr,glide.authenticate.external.side_door_uri,glide.entry.page.script,glide.entry.page,glide.entry.first.page.script,glide.entry.loggedin.page,glide.entry.loggedin.page_ess,glide.authenticate.sso.saml2.debug,glide.authenticate.sso.saml2.clockskew,glide.authenticate.sso.redirect.idp,glide.ldap.authentication,glide.script,glide.ui.escape_all_script,glide.ui.security.codetag.allow_script,glide.ui.security.allow_codetag,com.glide.attachment.max_size,glide.security.file.mime_type.validation,glide.security.manager,glide.sm.default_mode,glide.security.strict.updates,glide.security.granular.create,glide.security.explain.write.locks,glide.ui.forgetme,glide.ui.secure_cookies,glide.secure_cookie.debug,glide.script.use.sandbox,glide.script.allow.ajaxevaluate,glide.script.secure.ajaxgliderecord,com.glide.communications.trustmanager_trust_all,glide.outbound.sslv3.disabled,glide.ui.escape_text,glide.ui.rotate_sessions,glide.security.password_reset.uri,glide.security.strict.actions,glide.security.use_csrf_token,glide.ui.escape_html_list_field,glide.html.escape_script,glide.smtp.auth,glide.soap.strict_security,glide.basicauth.required.wsdl,glide.basicauth.required.csv,glide.basicauth.required.excel,glide.basicauth.required.importprocessor,glide.basicauth.required.pdf,glide.basicauth.required.rss,glide.basicauth.required.scriptedprocessor,glide.basicauth.required.soap,glide.basicauth.required.unl,glide.basicauth.required.xml,glide.basicauth.required.xsd,glide.cms.catalog_uri_relative,glide.set_x_frame_options,glide.ui.attachment.download_mime_types,glide.security.groupby_acl_check,glide.security.diag_txns_acl,glide.login.autocomplete,glide.security.csrf_previous.allow,glide.security.csrf_previous.time_limit,glide.security.csrf.strict.validation.mode,glide.basicauth.required.schema,glide.http.connection_timeout,glide.http.timeout,glide.soap.max_redirects,glide.soap.request_processing_timeout,glide.soapprocessor.allow_long_running_threads,glide.soapprocessor.max_long_running_threads,glide.security.csrf.handle.ajax.timeout,glide.security.auto.resubmit.ajax,glide.ui.auto_req.extend.session,glide.session.unauthorized.timeout.enabled,glide.session.unauthorized.timeout,glide.ui.session_timeout,com.glide.ssl.read.timeout,glide.integration.session_timeout,glide.security.ssl.protocols,glide.security.ssl.ciphersuites^ORnameSTARTSWITHglide.authenticate.^ORnameSTARTSWITHglide.security.^ORnameSTARTSWITHglide.entry.^ORnameSTARTSWITHglide.script.^ORnameSTARTSWITHglide.basicauth.^ORnameSTARTSWITHglide.session.^ORnameSTARTSWITHglide.soapprocessor.')+";");

function generate_properties(vencodedquery) {
    var vresult = [],
        vlist = {};
    var a = new GlideRecord("sys_properties");
    if (vencodedquery) try {
        a.addEncodedQuery(vencodedquery);
        a.setLimit(100);
        a.orderByDesc("sys_created_on");
        for (a.query(); a.next();) vlist[a.name] = {}, vlist[a.name].value = a.value + "";
        vresult.push(JSON.stringify(vlist) + "")
    } catch (e) {
        vresult.push("Error: generate_properties " + e)
    } else vresult.push("Error: generate_properties 'vencodedquery' is required " + vencodedquery);
    return vresult
};   
   
   
// var tocompareto = {"glide.authenticate.sso.saml2.keystore":{"value":"b88267271b012000f1129141be071393"},"glide.script.allow_unsafe_gs_sql":{"value":"false"},"glide.ui.session_timeout":{"value":"30"},"com.glide.communications.trustmanager_trust_all":{"value":"false"},"glide.outbound.sslv3.disabled":{"value":"true"},"glide.security.file.mime_type.validation":{"value":"false"},"glide.security.forgot_password.display.link":{"value":"true"},"glide.security.password_reset.uri":{"value":"/$pwd_reset.do?sysparm_url=ss_default"},"glide.basicauth.required.xmloutputprocessor":{"value":"true"},"glide.security.scoped_administration.honor_global_acl":{"value":"true"},"glide.security.expander.view.legacy":{"value":"false"},"glide.security.scoped_administration":{"value":"true"},"glide.security.multisso.check_table_exists_for_clone":{"value":"true"},"glide.authenticate.multisso.user.autoprovision":{"value":"false"},"glide.security.admin.override.accessterm":{"value":"true"},"glide.basicauth.required.schema":{"value":"true"},"glide.soap.request_processing_timeout":{"value":"60"},"glide.authenticate.sso.saml2.idp.supportForceAuthn":{"value":"true"},"glide.security.groupby_acl_check":{"value":"true"},"glide.userauthgate.extauth.check":{"value":"true"},"glide.basicauth.required.api":{"value":"true"},"glide.authenticate.multisso.login_locate.user_field":{"value":"user_name"},"glide.authenticate.multisso.enabled":{"value":"false"},"glide.authenticate.multisso.debug":{"value":"false"},"glide.security.diag_txns_acl":{"value":"false"},"glide.basicauth.required.jsonv2":{"value":"true"},"glide.authenticate.sso.saml2.require_signed_authnrequest":{"value":"false"},"glide.authenticate.sso.saml2.sign_algorithmURI":{"value":"http://www.w3.org/2000/09/xmldsig#rsa-sha1"},"glide.security.csrf.strict.validation.mode":{"value":"false"},"glide.login.autocomplete":{"value":"false"},"glide.security.strict_elevate_privilege":{"value":"true"},"glide.security.sandbox_no_logging":{"value":"true"},"glide.authenticate.sso.saml2.signing_key_password":{"value":"saml2sp"},"glide.authenticate.sso.saml2.signing_key_alias":{"value":"saml2sp"},"glide.authenticate.sso.saml2.idp_logout_binding":{"value":"urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect"},"glide.authenticate.sso.saml2.require_signed_logoutrequest":{"value":"false"},"glide.authenticate.sso.saml2.clockskew":{"value":"180"},"glide.authenticate.sso.saml2.idp":{"value":"http://idp.ssocircle.com"},"glide.authenticate.sso.saml2.audience":{"value":"https://yourinstance.service-now.com"},"glide.authenticate.sso.saml2.createrequestedauthncontext":{"value":"true"},"glide.authenticate.sso.saml2.authncontextclassref":{"value":"urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"},"glide.ui.attachment.download_mime_types":{"value":"text/html,image/svg,image/svg+xml"},"glide.ui.escape_all_script":{"value":"true"},"glide.set_x_frame_options":{"value":"true"},"glide.cms.catalog_uri_relative":{"value":"true"},"glide.sm.default_mode":{"value":"deny"},"glide.authenticate.sso.saml2.debug":{"value":"false"},"glide.authenticate.failed_redirect":{"value":"logout_success.do"},"glide.authenticate.external.logout_redirect":{"value":"external_logout_complete.do"},"glide.authentication.external.disable_local_login":{"value":"true"},"glide.security.csrf_previous.time_limit":{"value":"86400"},"glide.security.use_csrf_token":{"value":"true"},"glide.security.csrf_previous.allow":{"value":"false"},"glide.ui.escape_html_list_field":{"value":"true"},"glide.ui.escape_text":{"value":"true"},"glide.html.escape_script":{"value":"true"},"glide.ui.rotate_sessions":{"value":"true"},"glide.security.strict.actions":{"value":"true"},"glide.smtp.auth":{"value":"false"},"glide.authenticate.sso.saml2.idp_authnrequest_url":{"value":"https://idp.ssocircle.com:443/sso/SSORedirect/metaAlias/ssocircle"},"glide.authenticate.sso.saml2.idp_logout_url":{"value":"https://idp.ssocircle.com:443/sso/IDPSloRedirect/metaAlias/ssocircle"},"glide.authenticate.sso.saml2.nameid_policy":{"value":"urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress"},"glide.authenticate.sso.saml2.user_field":{"value":"user_name"},"glide.authenticate.sso.saml2.issuer":{"value":"https://yourinstance.service-now.com"},"glide.authenticate.sso.saml2.service_url":{"value":"https://yourinstance.service-now.com/navpage.do"},"glide.authenticate.failed_requirement_redirect":{"value":"https://idp.ssocircle.com:443/sso/SSORedirect/metaAlias/ssocircle"},"glide.ui.security.codetag.allow_script":{"value":"false"},"glide.basicauth.required.scriptedprocessor":{"value":"true"},"glide.script.secure.ajaxgliderecord":{"value":"true"},"glide.script.allow.ajaxevaluate":{"value":"false"},"glide.script.use.sandbox":{"value":"true"},"glide.security.strict.updates":{"value":"true"},"glide.basicauth.required.xsd":{"value":"true"},"com.glide.attachment.max_size":{"value":"1024"},"glide.basicauth.required.importprocessor":{"value":"true"},"glide.secure_cookie.debug":{"value":"false"},"glide.basicauth.required.xml":{"value":"true"},"glide.basicauth.required.unl":{"value":"true"},"glide.entry.page.script":{"value":"new CMSEntryPage().getEntryPage()"},"glide.ui.secure_cookies":{"value":"true"},"glide.ui.security.allow_codetag":{"value":"true"},"glide.basicauth.required.pdf":{"value":"true"},"glide.basicauth.required.excel":{"value":"true"},"glide.basicauth.required.csv":{"value":"true"},"glide.ldap.authentication":{"value":"true"},"glide.soap.strict_security":{"value":"true"},"glide.authenticate.secret_key":{"value":""},"glide.authenticate.header.encrypted_key":{"value":"DE_USER"},"glide.security.explain.write.locks":{"value":"false"},"glide.security.granular.create":{"value":"true"},"glide.security.manager":{"value":"com.glide.sys.security.ContextualSecurityManager"},"glide.basicauth.required.rss":{"value":"true"},"glide.basicauth.required.wsdl":{"value":"true"},"glide.basicauth.required.soap":{"value":"true"},"glide.soapprocessor.large_field_patch_max":{"value":"512000"},"glide.authenticate.header.value":{"value":"user_name"},"glide.authenticate.header.key":{"value":"SM_USER"},"glide.authenticate.external":{"value":"false"}};
// gs.print('RESULT\n' + compareproperties('nameINcom.glide.ssl.read.timeout,glide.http.connection_timeout,glide.http.timeout,glide.integration.session_timeout,glide.security.auto.resubmit.ajax,glide.security.csrf.handle.ajax.timeout,glide.security.ssl.ciphersuites,glide.security.ssl.protocols,glide.session.unauthorized.timeout,glide.session.unauthorized.timeout.enabled,glide.soap.max_redirects,glide.soap.request_processing_timeout,glide.soapprocessor.allow_long_running_threads,glide.soapprocessor.max_long_running_threads,glide.ui.auto_req.extend.session,glide.ui.session_timeout',tocompareto));
   
function compareproperties (vencodedquery, tocompareto) {
    var vresult = [],
        vlist = [];
    var a = new GlideRecord("sys_properties");
    if (vencodedquery) try {
        a.addEncodedQuery(vencodedquery);
        a.setLimit(100);
        a.orderByDesc("sys_created_on");
        for ( a.query(); a.next();) 
        	(tocompareto && tocompareto[a.name]) ? ((tocompareto[a.name].value != a.value ) && vresult.push(a.name + "")) : vresult.push(a.name + "");
    } catch (e) {
        vresult.push("Error: generate_properties " + e)
    } else vresult.push("Error: generate_properties 'vencodedquery' is required " + vencodedquery);
    return vresult.join(',')
}

// gs.print('RESULT\nvar tocompareto = ' + generate_script_hashes('sys_properties','nameINglide.authenticate.multisso.user.autoprovision',"name,value")+";");

function generate_script_hashes(vtable, vencodedquery, vfields) {
    var vresult = [],
        vlist = {};
    var a = new GlideRecord(vtable);
    vfields = vfields ? vfields.split(',') : "name,script";
    if (vencodedquery) try {
        a.addEncodedQuery(vencodedquery);
        a.setLimit(100);
        a.orderByDesc("sys_created_on");
        for (a.query(); a.next();) vlist[a.getValue(vfields[0])] = {}, vlist[a.getValue(vfields[0])].hash = hashCode(a.getValue(vfields[1])) + "";
        vresult.push(JSON.stringify(vlist) + "")
    } catch (e) {
        vresult.push("Error: generate_script_hashes " + e)
    } else vresult.push("Error: generate_script_hashes 'vencodedquery' is required " + vencodedquery);
    return vresult
};  

//var tocompareto = {"glide.authenticate.multisso.user.autoprovision":{"value":"93196323"}};
//gs.print('RESULT\n' + compare_script_hashes('sys_properties','nameINglide.authenticate.multisso.user.autoprovision',tocompareto,"name,value"));
 
function compare_script_hashes (vtable, vencodedquery, tocompareto,vfields) {
    var vresult = [],
        vlist = [];
    var a = new GlideRecord(vtable);
    vfields = vfields ? vfields.split(',') : "name,script";
    if (vencodedquery) try {
        a.addEncodedQuery(vencodedquery);
        a.setLimit(100);
        a.orderByDesc("sys_created_on");
        for (a.query(); a.next();) 
        	(tocompareto && tocompareto[a.getValue(vfields[0])]) ? ((tocompareto[a.getValue(vfields[0])].hash != hashCode(a.getValue(vfields[1])) ) && vresult.push(a.getValue(vfields[0]) + "")) : vresult.push(a.getValue(vfields[0]) + "");
    } catch (e) {
        vresult.push("Error: compare_script_hashes " + e)
    } else vresult.push("Error: compare_script_hashes 'vencodedquery' is required " + vencodedquery);
    return vresult.join(',')
}

// var a = "stering";
// var b = "stering ";
// gs.print(hashCode(a));
// gs.print(hashCode(b));
function hashCode(a) {
  if (!a) {return 0};
  var hash = 0, i, chr;
  if (0 === a.length) return hash;
  for (i = 0; i < a.length; i++) {
    chr   = a.charCodeAt(i);
    hash  = ((hash << 5) - hash) + chr;
    hash |= 0; // Convert to 32bit integer
  }
  return hash;
};

// generate_properties ======


